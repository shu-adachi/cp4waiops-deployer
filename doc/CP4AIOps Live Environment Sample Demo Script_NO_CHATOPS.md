<center> <h1>Cloud Pak for Watson AIOps </h1> </center>
<center> <h2>Sample Demo Script for the live demo environment</h2> </center>

![K8s CNI](./demo/00_aimanager_insights.png)

<center> ©2023 Włodzimierz Dymaczewski/Niklaus Hirt / IBM </center>

# 1. Introduction

このスクリプトは、Cloud Pak for Watson AIOps本体とデモアプリケーションをライブデモ環境で動かしてデモするためのガイドとして作成されています。</br>
このスクリプトは、いくつかのセクションで説明されています。</br>
お客様のニーズに応じて、一部またはすべてのセクションを使用できます。

このスクリプトは、[TechZone](https://techzone.ibm.com/collection/cp4waiopsdemo#tab-1)経由で予約するか、[自分でインストール](https://github.com/niklaushirt/cp4waiops-deployer#-1-quick-install)できるCloud Pak for Watson AIOps 3.xのライブデモ環境で使用することを意図しています。

デモ・スクリプトでは、
- “**🚀 <u>アクション</u>**” は、プレゼンターの設定ステップを示します。
- “**📣 <u>ナレーション</u>**” は、プレゼンターが話す内容を意味します。 
- “**ℹ️ <u>メモ</u>**” は、プレゼンターがこのデモスクリプトから逸脱したり、補足コメントを追加したりする必要がある箇所を示します。

<div style="page-break-after: always;"></div>

## 1.1 主な用語

Cloud Pak for Watson AIOps について説明する際には、以下の用語に精通している必要があります。

- **アプリケーション**
   - さまざまなデータ・タイプのリソースをアプリケーションにグループ化する機能を提供します。
   - お客様は、ビジネス・ニーズに合わせてアプリケーションを柔軟に定義できます。
   - アプリケーションを使用すると、リソースの統合ビューを取得し、相互依存関係を理解することができます。
- **イベント**
   - 現時点で、お客様の環境のどこかで何かが起こったことを伝えるものです。
   - 何が起こったのか、どこで起こったのか、いつ起こったのかを教えてくれます。
   - イベントは例外的なものであったり、対処可能なものであったりする必要はなく、単に何かが起こったことを伝えるものです。
- **アラート**
   - アラートは、解決が必要な環境のどこかでの異常状態を表します。
   - 何が起きているのか、どこで起きているのか、いつから起きているのかを教えてくれます。
   - 1つまたは複数のイベントによって通知されることがあります。
   - 開始時刻と終了時刻が含まれます。 
- **ストーリー**
   - ストーリーは、現在お客様に影響を及ぼしており、迅速な修復が必要なサービスが停止しているまたは機能が低下していることを表しています。
   - サービスの停止または機能の低下を示す 1 つ以上のトリガー・アラートに基づいて作成されます。
   - 重大度が「重要(Major)」または「重大(Critical)」のアラートは、トリガー・アラートとして機能します。
   - 同じ原因を共有する他のアラートは、ストーリーにコンテキストを追加することができます。
- **インシデント**
   - ServiceNow 内のインシデントは、正常なサービス運用の中断または機能低下が発生した場合に発生します。
   - ServiceNow のオープン・インシデントは、顧客に影響があるか、ビジネス・リスクを表していることを意味します。
- **トポロジー**
   - トポロジーは、構成要素がどのように相互に関連しているかを表現したものです。
   - Cloud Pak for Watson AIOps ではアルゴリズムが、イベントノードが互いにどのように近接しているかを分析し、トポロジーベースの相関関係にグループ化します。

<div style="page-break-after: always;"></div>

## 1.2 デモUIの操作

![image](./demo/image.054.png)

重要な機能は以下となります。

1. **CP4WAIOpsへのアクセス (提供されている認証情報を使ってログイン)**
2. **既存のストーリーとアラートを全てクリアする**
3. **インシデント/ストーリーを作成する**

> ℹ️ デモUIへのログインを求められた場合は、トークン/パスワードを使用してください。`P4ssw0rd!`

> ⚠️ デモを開始する前に、CP4WAIOpsを開き、保留中のストーリーやアラートがないことを確認する必要があります。もし、数時間前に作成されたもの（誰かがデモを完了しなかった残り）がある場合は、上記2の手順でデモUIを使用してクリーンアップすることができます。

<div style="page-break-after: always;"></div>

## 1.3 デモシナリオ

### 1.3.1 概要

このユース・ケースでは、IBM Cloud Pak for Watson AIOps がエンド・ユーザーに影響を与えるアプリケーションのダウンタイムやインシデントの回避を積極的に支援する様子をお客様にお見せします。</br>
あなたはSRE/運用担当者として、RobotShopアプリケーションに顧客の評価が表示されないことを示すSlackメッセージを受け取った役を演じています。</br>
RobotShop は、架空の会社がロボットを販売する主要なプラットフォームで、顧客の評価が表示される機能は RobotShop アプリケーションにとって重要な機能です。

### 1.3.2 Use Case

このユース・ケースでは、Cloud Pak for Watson AIOps が SRE/Operations チームが問題を特定し、検証し、最終的に修正する際にどのように支援できるかを説明します。</br>
このデモンストレーションでは、Instana、Turbonomic、ServiceNow、および Slack との連携が紹介されます。</br>
Slack は、このインシデントの処理に使用される ChatOps 環境です。

Cloud Pak for Watson AIOps の主な販売ポイントを以下に示します。

1. **さまざまな IT プラットフォームからデータを引き出します。**
   - IBM Cloud Pak for Watson AIOps は、ログ、メトリック、アラート、トポロジー、チケットなどの受信データフィールドを監視し、ト学習済みの機械学習モデルに基づいて、受信データ全体の潜在的な問題を強調表示します。
1. **AI と自然言語処理を活用します。**
   - インサイトレイヤーは、AI や自然言語処理技術を活用して、構造化データと非構造化データの点と点をつなぎます。
   - これにより、インシデントの本質を素早く理解することができます。
1. **信頼性と透明性を提供します。**
   - 正確で信頼性の高いレコメンデーションを使って、IT システムの問題の診断と、最適な解決策の特定と優先順位付けを進めることができます。
1. **迅速に解決します。**
   - 自動化を可能にし、事前に訓練されたモデルを活用することで、すぐに使える生産性から時間とコストを節約できます。
   - 過去のインシデントからの「類似問題機能」によって、お客様やエンドユーザーのためにサービスをオンラインに戻すことができます。

<div style="page-break-after: always;"></div>

## 1.4 デモの流れ
1. シナリオの紹介
1. トリガーとなる障害の状況説明
1. RobotShopアプリの状況確認
1. インシデントの理解と解決
   1. CP4WAIOpsにログイン
   1. ストーリーを開く
   1. ストーリーを調べる
   1. ストーリーを確認する
   1. 類似のインシデント
   1. アラートを確認する
   1. インシデントを理解する
   1. トポロジーを確認する
   1. [オプション] トポロジーの詳細
   1. runbook automationで問題を解決する
   1. インシデントを解決する
1. まとめ

# 2. デモの実施

## 2.1 デモの背景の説明

**📣 <u>ナレーション</u>** 

Cloud Pak for Watson AIOpsのデモへようこそ。</br>
このデモでは、Watson AIOps がミッションクリティカルなワークロードのインシデントをプロアクティブに特定、診断、解決するために、運用チームをどのように支援するかを紹介します。

以下の手順を確認できます。
- Watson AIOps は、ログ、メトリック、イベント、チケット、トポロジーなどのさまざまな情報をインテリジェントに相関させます。
- これらの情報はすべて要約され、大量の関連性のないアラートではなく、実用的なアラートとして表示されます。
- Watson AIOps の自動化機能により、通知を受けてから数秒から数分以内に問題を解決できます。

デモでは、RobotShop というあらゆるタイプのアプリケーションのプロキシーとして機能するサンプルアプリを使用します。</br>
アプリケーションはマイクロサービスアーキテクチャーで構築されており、サービスは Kubernetes のクラスター上で実行されます。

>**🚀 <u>アクション</u>**</br>
>[デモ用のパワーポイント](https://github.com/niklaushirt/cp4waiops-deployer/blob/main/doc/CP4AIOPS_DEMO_2023_V1.pptx?raw=true)を使って紹介します。

**📣 <u>ナレーション</u>**

**Slide 2**</br>
それではデモ環境を見てみましょう。</br>
サンプルアプリ「RobotShop」は、Kubernetes クラスターでマイクロサービスのセットとして動作しています。</br>
通常、このようなアプリケーションを保守する運用チームには、さまざまなデータの種類を収集するためのツール群を備えています。

**Slide 3**</br>
ここでは、WAIOPS（スライド3）にイベントを送信しているいくつかのシステムがあります。
- GitHub
- Turbonomic
- Instana
- Selenium
- Falcon (Sysdig)

これらのイベントはアラートとしてグループ化され、処理しなければならない信号の数を大幅に削減することができます。</br>
通常、約98～99％の削減率が確認されています。</br>
つまり、20,000件のイベントのうち、さらに優先順位をつけることができる約200～300件のアラートを得ることができるのです。

**Slide 4**</br>
WAIOpsはElasticSearchからもLogを取り込みます（これはSplunkや他のLog Aggregatorでも可能です）。</br>
ログの異常検知は、十分に稼働しているシステムでトレーニングされ、異常や異常値を検知することができるようになっています。</br>
異常が検出された場合、他のイベントと一緒にグループ化されます。

**Slide 5**</br>
WAIOpsはInstana（Dynatrace、NewRelicなど）からMetricを取り込みます。</br>
Metric Anomaly detectionは、十分に稼働しているシステムでトレーニングされ、ダイナミックベースラインを作成します。</br>
さまざまなアルゴリズムにより、異常や異常値を検出することができます。異常が検出された場合、他のイベントと一緒にグループ化されます。

**Slide 6**</br>
同じインシデントに関連するアラートは、いわゆる「ストーリー」にパッケージ化されます。</br>
ストーリーは、情報が入手可能になるにつれて充実し、更新されます。

 **Slide 7**</br>
その一例が、トポロジー情報です。</br>
Watson AIOpsは、利用者に問題があることを伝え、関連するすべてのイベントを提示するだけでなく、問題がシステムのどこに位置しているかを教えてくれます。

**Slide 8**</br>
さらに、ServiceNowのチケットから得られる過去の解決情報によって、ストーリーはより充実したものになります。</br>
詳しくはデモの中で説明します。

**Slide 9**</br>
ストーリーは、Watson AIOpsのWebインターフェースで確認することもできますし、ChatOpsのアプローチを採用しているチームであれば、SlackやTeamsにプッシュすることも可能です。

**Slide 10**</br>
運用保守担当者やSREがRunbookを作成した場合、Watson AIOpsは自動的にRunbookを起動し、問題を軽減することができます。

**ℹ️ <u>メモ</u>**: このデモでは、Slackは使用していません。

**📣 <u>ナレーション</u>**

それでは、デモを開始します。

<div style="page-break-after: always;"></div>

## 2.2 インシデントのトリガー

**❗ <u>メモ</u>**: 次のステップはクライアントに見せる必要はありません。可能であればバックグラウンドでアクションを実行しても構いません。

![image](./demo/image.054.png)

>**🚀 <u>アクション</u>**</br>
>CP4WAIOps Demo UIを開き、インシデントを発生させます。
>- Watson AIOpsのホーム画面の[Get started with the DemoUI]からDemo UI にアクセス 
>- トークン `P4ssw0rd!` でログイン
>- デモで使用したいインシデント `(3)` をトリガーしてください。
> このアクションにより、シミュレートされたイベントのストリームがシステムに注入され、実際に発生する可能性があるエラーが再現されます。

<div style="page-break-after: always;"></div>

## 2.3 RobotShopアプリの状況確認

### 2.3.1 アプリケーションを表示する

![image](./demo/image.089.png)

>**🚀 <u>アクション</u>**</br>
>RobotShopアプリケーションを起動します。
>**Demo UI** の **Third-Party** にリンクがあります。アプリケーションのUIで遊んでみてください。

**📣 <u>ナレーション</u>**
このデモでは、私はアプリケーションSRE（サイト・リライアビリティ・エンジニア）として、自社が運営するRobotShopというEコマースサイトの責任者をしています。
日中（顧客の購入が多い時間帯）、私の携帯にSlackのメッセージが届き、サイトに何らかの問題が発生していることを知らせてきました。
RobotShopのサイトで何が起こっているのか検証してみましょう。
アプリケーションは起動しているが、レビューを取得できないというエラーが表示されています。

<div style="page-break-after: always;"></div>

### 2.3.2 レーティングが機能していないことの確認

![image](./demo/image.088.png)

>**🚀 <u>アクション</u>** Robotの詳細を開くと、レーティングが表示されていないことがわかります。


**📣 <u>ナレーション</u>**

私たちが販売する各製品には多くの評価があるため、何も表示されない場合は、アプリケーション内の「評価」サービスに問題がある可能性が高く、顧客の購買決定に大きな影響を与える可能性があり、また、より広範囲な障害の兆候である可能性があります。

<div style="page-break-after: always;"></div>

## 2.4 インシデントの理解

### 2.4.1 CP4WAIOpsにログイン

![image](./demo/image.054.png)

>**🚀 <u>アクション</u>**
デモUIで、**CP4WAIOps `(1)`** をクリックします。

![image](./demo/image.055.png)

**📣 <u>ナレーション</u>**

Watson AIOpsで作成されたインシデントを詳しく見てみましょう。

<div style="page-break-after: always;"></div>

### 2.4.2 ストーリーを開く

![image](./demo/image.056.png)  

>**🚀 <u>アクション</u>**
左上の "ハンバーガーメニュー" をクリックします。**ストーリー＆アラート**をクリックします。

![image](./demo/image.057.png)

**📣 <u>ナレーション</u>**

シミュレーションによって**ストーリー**が作成されたことがわかります。**ストーリー**には、目下の事故に関連する情報がグループ化されています。これは、通常、障害発生時に設置される古典的な"War Room"(即時決断を実施するための会議)に相当するものです。
**ストーリー**には、関連するログの異常、トポロジー、類似のインシデント、過去のトラブルチケットに基づく推奨アクション、関連イベント、Runbookなどが含まれています。

<div style="page-break-after: always;"></div>

### 2.4.3 ストーリーを確認

![image](./demo/image.056.png)  

>**🚀 <u>アクション</u>**
左上の "ハンバーガーメニュー"をクリックします。**ストーリー＆アラート**をクリックします。

![image](./demo/image.057.png)

**📣 <u>ナレーション</u>**

それでは、**ストーリー**をご覧ください。

![image](./demo/image.059.png)

前述したように、「ストーリー」は、Watson AIOpsによって特定された、目下の事件に関するすべての関連情報を再集約します。

1. Watson AIOpsが最も可能性の高い原因として特定したアラートのリスト
2. トポロジーに関連する問題を局所化
3. インシデントを自動的に軽減するための提案されたRunbook
4. 現在発生しているインシデントに類似したインシデント
5. ストーリーのステータス - ここでストーリーのステータスと優先度を変更することができます。

<div style="page-break-after: always;"></div>

### 2.4.4 ストーリーを認識する

>**🚀 <u>Action</u>**<br/>
>**ストーリーの設定変更.** をクリックします<br/>
>**ステータスの変更** を選択します<br/>
>**進行中** をクリックします

![image](./demo/image.079.png)  

**📣 <u>ナレーション</u>**

まず、「ストーリー」の検証を続ける前に、私がこの事件に取り組んでいることを同僚に知らせたいと思います。そこで、「進行中」に設定しておきます。

<div style="page-break-after: always;"></div>

### 2.4.5 類似のインシデント

>**🚀 <u>Action</u>**
最も類似した、解決対象チケットをクリックします

![image](./demo/image.060.png)  

**📣 <u>ナレーション</u>**

ほとんどの大企業は、ITサービス管理ツールを使用して、IT周辺のプロセスを管理しています。</br>
私たちの組織では、その目的でServiceNowを使用しています。</br>
過去のインシデントと解決情報は、Watson AIOpsによって取り込まれ、分析されます。</br>

IBM Cloud Pak for Watson AIOpsは、既存のチケットに対してトレーニングを行い、過去のインシデントの解決に使われた手順（文書化されている場合）を抽出し、自然言語処理を使って解決方法を推奨します。</br>
このAIモデルは、現在の問題の修復を支援するために、過去のインシデントを発見するのに役立ちます。

つまり、**ストーリー**について、あなたのチームには過去の類似インシデントの上位ランクが提示されるのです。</br>
これらの関連する類似インシデントは、私がServiceNowにアクセスできない場合でも、インシデント解決のスピードアップに貢献します。</br>
このような機能がない場合、チームは過去のインシデントと解決策を手動で検索する必要があり、これは時間のかかる作業です。

この例では、問題はリソース制限を大幅に削減する GIT コミットが mysql デプロイメントで DEV によってコミットされたことに関連していることがわかります。

この問題に対して、どのように解決されたかを確認してみましょう。

**❗ <u>メモ</u>**:  ロボットショップのデモシナリオでは、ServiceNowとの連携を静的コンテンツでシミュレートしています。 

<div style="page-break-after: always;"></div>

#### 解決情報

>**🚀 <u>アクション</u>**
>**Resolution Information** タブをクリックします。

![image](./demo/image.076.png)  

**📣 <u>ナレーション</u>**

mysqlのデプロイメントを変更することで解決し、問題を軽減するためのRunbookが作成されていたようです。

仕上げに、今回の事件が公式な変更に関連したものであるかどうかを確認します。

<div style="page-break-after: always;"></div>

#### 変更を確認する

![image](./demo/image.077.png)

>**🚀 <u>アクション</u>** <br/>
>**Related Records** タブをクリックします。 <br/>
>**i** ボタンをクリックし、**Caused by Change**をクリックします。

![image](./demo/image.078.png)  

<div style="page-break-after: always;"></div>

**📣 <u>ナレーション</u>**

この問題は、mysqlデータベースのフットプリントを削減することを目的とした変更に関連していることがわかりました。

まだ進行中なので、開発チームが同様の問題を再現した可能性が高いです。

もちろん、現実にはRunbookを起動して、問題が解決されるかどうかを確認します。
しかし、デモのために、まずもう少し深く掘り下げてみましょう。

<div style="page-break-after: always;"></div>

### 2.4.6 アラートの確認

>**🚀 <u>アクション</u>**

ServiceNowのページを閉じて、**Alerts** タブをクリックします。

![image](./demo/image.061.png)  

**📣 <u>ナレーション</u>**

アラートは重要度順に並んでいるのではなく、AIエンジンが関連性でランク付けしていることに注目してください。根本原因に関連する可能性が高いものが上位に表示されています。1行目を見て、もう少し詳しく見てみましょう。

>**🚀 <u>アクション</u>**

リストの最初のAlertをクリックします。

**📣 <u>ナレーション</u>**

**アラートの詳細**では、特定のアラートがストーリーに追加された理由を説明するさまざまな種類のグループ分けを見ることができます。

<div style="page-break-after: always;"></div>

#### スコープに基づくグループ化

>**🚀 <u>アクション</u>**
**Scope-based grouping**をクリックします。

![image](./demo/image.027.png)

**📣 <u>ナレーション</u>**

短時間（デフォルトは15分）に同じリソースで発生したため、ストーリーに追加されたアラートもあります

#### トポロジカル・グループ化

>**🚀 <u>アクション</u>**
**Topological grouping**をクリックします。

![image](./demo/image.028.png)

**📣 <u>ナレーション</u>**

他のアラートは、論理的または物理的に関連するリソースで発生したため、グループ化されました。</br>
この相関は、異なるソースからのトポロジー情報をつなぎ合わせるアプリケーション トポロジー サービスを使用しています。

<div style="page-break-after: always;"></div>

#### 時間的なグループ分け

>**🚀 <u>Action</u>**
**Temporal correlation** をクリックします。

![image](./demo/image.029.png)

**📣 <u>ナレーション</u>**

最後に、時間的相関は、以前、歴史上、短い時間枠の中で互いに接近して起こることが知られているイベントをストーリーに加えます。</br>
ここで最も重要なのは、これらの相関関係がすべて自動的に起こるという事実です。高度にダイナミックで分散したクラウドネイティブアプリケーションでは、これは多くの時間と労力を節約する大きな利点となります。

>**🚀 <u>アクション</u>**
アラートの詳細ウィンドウを閉じます。

<div style="page-break-after: always;"></div>

### 2.4.7 インシデントのタイムライン

>**🚀 <u>Action</u>**
>**Last occurence** ヘッダーをダブルクリックします。 <br/>
>***結果**： "Commit in repository robot-shop by Niklaus Hirt on file robot-shop.yaml "は一番下にあるはずです。*

![image](./demo/image.063.png)  

**📣 <u>ナレーション</u>**

インシデント時に何が起こったかを理解しようとするとき、私はアラートを発生順に並べ替えます。これにより、イベントの連鎖を理解することができます。

* 最初のイベントは、**GitHub** にコミットされたコード変更であることがわかります。説明文にカーソルを合わせると、全文が表示されます。
つまり、開発チームがmysqlデータベースの利用可能なメモリーを減らしたようです。

他の出来事もこの仮説を裏付けています。
* CI/CD プロセスが起動し、セキュリティツールによって検出されたシステムにコード変更をデプロイするのを見ることができます。
* **Instana**はメモリサイズの変更を検出しました。


* そして、**Functional Selenium Tests** が失敗し始め、**Turbonomic** がメモリサイズの変更を検出します。
* **Turbonomic** は mysql データベースをスケールアップしようとします。
* **Instana** は、mysqlポッドがもう実行されておらず、レプリカが望ましい状態にマッチしていないことを教えてくれました。

<div style="page-break-after: always;"></div>

* Watson AIOps の Cloud Pak は、アプリケーションから来るログの正常で良いパターンを学びました。このストーリーには、mysql データベースにアクセスできないレーティング・サービスで検出された **Log Anomaly** が含まれています。

![image](./demo/image.064.png)

>**🚀 <u>アクション</u>**
タイプ欄に **ANOMALY:** とあるアラート行をクリックします。次に、**Metric Anomaly Details** アコーディオンを開きます。

**📣 <u>ナレーション</u>**

* Cloud Pak for Watson AIOpsは、複数のソースからメトリクスを収集し、**Metric Anomalies**を検出することも可能です。環境からの数百または数千のメトリクスでトレーニングされ、動的なベースラインを構築します（緑で表示）。グラフィックが突然赤くなるのは、データベースが通常よりも大量のメモリを消費しているときに検出された異常に関連しています。

![image](./demo/image.065.png)

>**🚀 <u>アクション</u>**
(1) **関連アラート**で、いくつかの追加アラートを選択します。

**📣 <u>ナレーション</u>**

複数のアラートを同時に表示することで、時間的な依存関係をより理解することができます

<div style="page-break-after: always;"></div>

>**🚀 <u>アクション</u>**
(2) マウスでグラフの一部を選択して拡大する

**📣 <u>ナレーション</u>**

では、拡大して異常がよくわかるようにしましょう。

![image](./demo/image.066.png)

>**🚀 <u>アクション</u>**
データポイントにカーソルを合わせると、ビフォーアフターが表示されます。

**📣 <u>ナレーション</u>**

この事件によって**Latencies**が急上昇し、**Transactions per Seconds**がほとんどゼロになっていることがよくわかります。これでまた、問題の原因を確認することができました。

>**🚀 <u>Action</u>**
Metric anomaly 詳細ビューを閉じる。

<div style="page-break-after: always;"></div>

## 2.5 トポロジーの操作

### 2.5.1 トポロジーを検証する


>**🚀 <u>アクション</u>**
>**Topology** タブをクリックします。

![image](./demo/image.067.png)

**📣 <u>ナレーション</u>**

このインターフェースは、インシデントに関連するアプリケーションの **トポロジー** を表示します。IBM Cloud Pak for Watson AIOps のトポロジー・サービスは、環境にあるリソース、リソースが互いにどのように関連しているか、そして環境が時間の経過とともにどのように変化してきたかについての作業理解を提供します。

カラフルなドットで示されたさまざまなリソースに、いくつかのステータスが付加されていることがわかります。ここでは、赤いステータスの **mysql** リソースの詳細とステータスを表示してみましょう。

<div style="page-break-after: always;"></div>

![image](./demo/image.068.png)  

>**🚀 <u>アクション</u>**
>リソース名 "**mysql**"が表示されているリソースを探します。次に、右クリックして、**リソースの詳細** を選択します。

>**🚀 <u>Action</u>**
>**Alerts** タブをクリックします。

![image](./demo/image.069.png)

**📣 <u>ナレーション</u>** 

トポロジーサービスは、運用チームに動的なインフラ、リソース、およびサービスに関する完全な最新の可視性を提供します。トポロジーサービスでは、特定のリソースに対して詳細やその他の関連情報を照会することができます。ここでは、たとえば mysql データベースリソースのすべてのアラートを見ることができます。

<div style="page-break-after: always;"></div>


### 2.5.2 [オプション] トポロジーの深堀り

![image](./demo/image.070.png)

>**🚀 <u>アクション</u>**
>リソース名 "mysql "が表示されているリソースを探します。右クリックし、**Open in Topology Viewer.** を選択します。

![image](./demo/image.071.png)

**📣 <u>ナレーション</u>**

インターフェースには、mysqlリソースを取り巻くトポロジーが表示されます。**mysql** デプロイが **ratings** サービスによって呼び出され、特定のワーカーノードで実行されていることがわかります。

![image](./demo/image.072.png)

>**🚀 <u>アクション</u>**
>ホップ数を `4` に変更し、**Render** をクリックします。



**📣 <u>Narration</u>**

また、グラフのサイズを大きくすることもできますが、やはり **mysql** のデプロイメントがベースになっています。

![image](./demo/image.073.png)

>**🚀 <u>アクション</u>**
>mysqlを右クリックし、**Show last change in timeline** を選択し、**Delta** をチェックします。

![image](./demo/image.074.png)

**📣 <u>ナレーション</u>**

ここで、**mysql** コンポーネントの履歴イベントを調べてみます。 **mysql** リソースで発生した **アラート** を時系列で確認することができます。

<div style="page-break-after: always;"></div>

## 2.6 インシデントを解決する

### 2.6.1 runbookの自動化の問題を解決する
>**🚀 <u>アクション</u>**
>**Overview** タブをクリックします。

![image](./demo/image.080.png)

**📣 <u>ナレーション</u>**

さて、問題の原因がわかったところで、起きてしまったことを修正しましょう。Runbookが自動的に特定されましたが、実行されていません。Runbookは、IT運用チームがトラブルシューティングや問題解決に使用するガイド付きステップです。組織によっては、これを標準作業手順書やPlaybookと呼ぶ場合もあります。インシデントが発生すると、IBM Cloud Pak for Watson AIOps は、適切なRunbookを問題にマッチさせます。Runbookは、インシデントにマッチしたときに自動的に実行されるように設定することも、ユーザーの承認と参加を得て実行することも可能です。

<div style="page-break-after: always;"></div>

Runbookを実行してみましょう。

>**🚀 <u>アクション</u>**
>3つの点をクリックし、**実行**をクリックします。
>**Start Runbook**をクリックします。

![image](./demo/image.082.png)

>**🚀 <u>アクション</u>**
>ステップ1の**Run**をクリックします。

![image](./demo/image.083.png)

**❗ <u>メモ</u>**: Runbookの実行には数分かかることがあります。

<div style="page-break-after: always;"></div>

**📣 <u>ナレーション</u>**

先ほど開始したRunbookは、Ansible Tower上のPlaybookをキックオフします。クラスタに接続し、MySQLの展開のためにメモリをスケールアップする実行を追うことができます。

![image](./demo/image.084.png)

>**🚀 <u>アクション</u>** <br/>
>完了したら、**Complete**をクリックします。<br/>
>RobotShopアプリケーションを開いてください。レーティングが正しく表示されていることを確認します。 

![image](./demo/image.087.png)

**📣 <u>ナレーション</u>**

Runbookが期待通りに動いたかどうかを確認する前に、RobotShopのアプリケーションが期待通りに動いているかどうかを確認する必要がありますね。

![image](./demo/image.085.png)

>**🚀 <u>アクション</u>** <br/>
>Runbookを評価する <br/>
>その後、**Runbook Worked** をクリックします。

**📣 <u>ナレーション</u>**

つまり、Runbookが問題を解決したのです。Watson AIOpsにRunbookが機能したことを伝えると、時間をかけて学習し、より適切なRunbookの優先順位付けや提案をするようになります。

<div style="page-break-after: always;"></div>

### 2.6.2 インシデントを解決する

>**🚀 <u>アクション</u>** <br/>
>**ストーリーの設定を変更**をクリックします。<br/>
>**ステータスの変更**を選択します。<br/>
>**解決済み**をクリックします。

![image](./demo/image.079.png)  

**📣 <u>ナレーション</u>**

これで問題が解決したので、ServiceNowのチケットを再開し、Storyを閉じることで、開発チームに問題を知らせます。

# Demonstration summary
**📣 <u>ナレーション</u>**

今日は、Cloud Pak for Watson AIOps が、SRE/運用チームがクラウドネイティブ環境で動作する最新の分散アプリケーションの問題を特定、検証し、最終的に修正するのを支援する方法を紹介しました。このソリューションでは、アプリケーションのトポロジーの自動検出、メトリクスとログの両方による異常検出、異なるソースからのイベントの高度な相関方法を提供します。
